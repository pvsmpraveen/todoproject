  <!DOCTYPE html>
  <html>
       {% load staticfiles %}
    <head>
         
      <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/css/materialize.min.css">
      <link rel="stylesheet" type="text/css" href="{% static 'css/todoapp.css' %}">
      <link rel="stylesheet" type="text/css" href="./../../../static/css/todoapp.css">
      
       <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    </head>

    <body>
     
    </div>
          <div class="container">
          <p id="loader">Loading...</p>
    </div>

    <div id="content">

    </div>
<!--    {% verbatim %}
    <script id="clientTemplate" type="text/html">
         <ul>
              ${id} - Name: ${user} ,${creation_date}
              {{each items}}
                  <li>${$value}
                        <button class='deleteitem'> Delete Item! </button>
                   </li>
              {{/each}}
           <button class='deletelist'> Delete List! </button>
          </ul>
     </script>
    {% endverbatim %}-->
    {% verbatim %}
    <script id="itemTemplate" type="text/html">
         <ul>
             <li> ${id} ${description} ${competed} ${due_by} </li>

          </ul>
     </script>
    {% endverbatim %}

    {% verbatim %}
    <script id="listTemplate" type="text/html">
          <ul>
              ${id} - Name: ${user} ,${creation_date}
              <button class='showlist' id="show_${id}"> Show List! </button>
              <button class='deletelist' id="del_${id}"> Delete List! </button>
          </ul>
     </script>
    {% endverbatim %}

          
      <script
            src="https://code.jquery.com/jquery-3.2.1.min.js"
            integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
            crossorigin="anonymous">
     </script>

     <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.2/js/materialize.min.js"></script>
     <script src="{% static 'js/todoapp.js' %}"></script>
     <script src="./../../../static/js/todoapp.js"></script>
     <script src="{% static 'js/jquery.tmpl.min.js' %}"></script>

     <script>
          $(document).ready(function(){
               var token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InVzZXIyIiwidXNlcl9pZCI6MywiZW1haWwiOiIiLCJleHAiOjE0OTgwNDE1MzF9.rgT-BL0kuJA-GMVbm8655IECoaBHqWMWooaxqC1x5sE"
               setTimeout(function(){
                    $('#loader').hide();

                    $.ajax({
                        url: "http://127.0.0.1:8000/todoapp/api/lists/",
                        headers: {
                            'Content-Type': 'application/json',
                            "Authorization": "JWT " + token
                        },
                        dataType: "json",
                        type: "GET",
                        contentType: "application/json; charset=utf-8",
                        success: function(data){
                            console.log(JSON.stringify(data));
                             $("#listTemplate").tmpl(data).appendTo('#content');
                        },
                        error:function(){
                             console.log("error");
                        }
                    });
               },1000);

               $('body').on('click','.deletelist',function(){
                  var id = $(this).attr('id').replace('del_','');
                  $('#loader').show();
                    setTimeout(function(){
                        $('#loader').hide();

                        $.ajax({
                            url: "http://127.0.0.1:8000/todoapp/api/lists/"+id+"/",
                            headers: {
                                'Content-Type': 'application/json',
                                "Authorization": "JWT " + token
                            },
                            dataType: "json",
                            type: "DELETE",
                            contentType: "application/json; charset=utf-8",
                            success: function(data){
                                console.log(JSON.stringify(data));
                                $("#itemTemplate").tmpl(data).appendTo('#content');
                                $(this).parent('ul').delete();
                            },
                                error:function(){
                                console.log("error");
                            }
                        });
                    },1000);
               });

               $('body').on('click','.showlist',function(){
                  var id = $(this).attr('id').replace('show_','');
                    $('#loader').show();
                    setTimeout(function(){
                        $('#loader').hide();

                        $.ajax({
                            url: "http://127.0.0.1:8000/todoapp/api/lists/"+id+"/items",
                            headers: {
                                'Content-Type': 'application/json',
                                "Authorization": "JWT " + token
                            },
                            dataType: "json",
                            type: "GET",
                            contentType: "application/json; charset=utf-8",
                            success: function(data){
                                console.log(JSON.stringify(data));
                                $("#itemTemplate").tmpl(data).appendTo('#content');
                            },
                                error:function(){
                                console.log("error");
                            }
                        });
                    },1000);

                  $(this).parent('ul').hide();
               });
          });
     </script>
     
    </body>
  </html>
        